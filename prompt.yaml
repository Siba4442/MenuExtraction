category_prompt: |
  {
    "task": "Analyze the provided menu image to identify the categories and subcategories of food items present.",
    "context": [
      "The restaurant name is: {{ restaurant_name }}",
      "The page number is: {{ page_number }}"
    ],
    "instructions": [
      "Perform a schematic analysis of the menu image.",
      "Identify and categorize the items in the menu under relevant headings (e.g., appetizers, main courses, desserts, beverages).",
      "Identify and categorize ONLY the main headings (not sub-items, not descriptions).",
      "Extract the category names EXACTLY as written in the menu image (preserve casing, punctuation, spacing).",
      "under each category, identify and list any subcategories (if present).",
      "Extract the subcategory names EXACTLY as written in the menu image (preserve casing, punctuation, spacing).",
      "Do not hallucinate new categories."
    ],
    "output_format": {
        "categories": [
            {
                "name": "string",
                "subcategories": ["string"]
            }
        ]
    },
    "additional_constraints": [
      "Provide the response in valid JSON format according to the schema.",
      "Treat only the top-level headings as categories (not every bold word).",
      "Categories must be unique. If no subcategories exist, use an empty array."
    ]
  }



categorry_items_prompt: |
  {
    "task": "Analyze the provided menu image and extract the item names and descriptions under the specified categories.",
    "context": [
        "The restaurant name is: {{ restaurant_name }}",
        "The page number is: {{ page_number }}",
        "Extract only for the provided categories.",
        "Do not add or rename any categories."
    ],
    "instructions": [
        "Perform a detailed and structured analysis of the menu image.",
        "Extract the item names and item descriptions for ONLY the categories provided below.",
        f"Use the following category list exactly as given: {{ categories }}",
        "Identify and categorize the items from the menu image under the exact matching categories.",
        "Extract the item name EXACTLY as written in the menu image (preserve casing, punctuation, spacing).",
        "Extract the item description EXACTLY as written. If the description does not exist, return null.",
        "Extract category-level descriptions exactly as written. If not available, return null.",
        "The response MUST follow the output schema exactly.",
        "Include a 'note' explaining extraction quality, missing categories, or inconsistencies.",
        "Provide ONLY the JSON output. No explanation or additional text outside JSON."
    ],
    "output_format": {
        "menu_categories": [
            {
                "Category_items": {
                    "category_name": {
                        "items": [
                            {
                                "item_name": "string",
                                "item_description": "string or null"
                            }
                        ]
                    }
                },
                "category_description": "string or null"
            }
        ],
        "note": "string"
    },
    "additional_constraints": [
        "The response MUST be strictly valid JSON according to the provided schema.",
        "DO NOT include categories not listed.",
        "DO NOT change the output keys or their nesting.",
        "DO NOT hallucinate item descriptionsâ€”return null if not present."
    ]
  }


extraction_prompt: |
  {
    "task": "Analyze the provided menu image and extract detailed structured menu data for the specified category.",

    "context": [
        "The page number is: {{ page_number }} of the menu.",
        "The category to extract is: {{ categories_page }}"
    ], 
    
    "instructions": [
        "You are given a single category and its items extracted from a previous OCR/detection stage.",
        "Your task is to re-read the image and precisely extract structured information ONLY for this category.",
        "DO NOT create new categories. DO NOT rename the category. Use the category name EXACTLY as provided.",
        "The category block (category name + items + descriptions) is provided below:",
        {{ category_block }}",
        
        "For each item, extract the following:",
        "- item_name: EXACTLY as shown in the menu (preserve original casing, spacing, punctuation).",
        "- variations: Extract variations IF they exist (e.g., Small, Regular, Large, Gluten-Free). If none, return null.",
        "- price: Extract the price for each variation. Must be numeric. If missing, return null.",
        "- description: Extract EXACT item description. If missing, return null.",
        "- piece: Extract number of pieces when mentioned (e.g., '6 pcs', '(2)', '4pc'). If not present, return null.",
        "- addons: Extract item-level addons ONLY if explicitly mentioned.",
        
        "Additionally:",
        "- Extract category-level addons IF they apply to the entire category.",
        "- Extract category-level description EXACTLY as shown. If none exists, return null.",
        
        "VERY IMPORTANT RULES:",
        "- DO NOT hallucinate any data (variations, prices, addons, or descriptions).",
        "- If a field is not shown in the image, return null for that field.",
        "- Output MUST strictly follow the provided schema.",
        "- Return ONLY the JSON output. No explanation, no commentary, no markdown."
    ],

    "output_format": {
        "category_name": "string",
        "items": [
            {
                "item_name": "string",
                "variations": [
                    {
                        "variation_name": "string or null",
                        "price": "float or null",
                        "description": "string or null"
                    }
                ],
                "addons": [
                    {
                        "addon_name": "string",
                        "price": "float or null"
                    }
                ],
                "piece": "integer or null"
            }
        ],
        "category_addons": [
            {
                "addon_name": "string or null",
                "price": "float or null"
            }
        ]
    },

    "additional_constraints": [
        "The output MUST be valid JSON.",
        "DO NOT include fields not present in the schema.",
        "Prices must be numeric floats.",
        "Return null for all missing or unavailable data.",
        "DO NOT infer or guess information."
    ]
  }
